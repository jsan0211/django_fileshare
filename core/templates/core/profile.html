{% extends 'base.html' %}

{% block content %}
<h2>Welcome, {{ request.user.username }}!</h2>
<p>This is your profile page.</p>

<h3>Your Uploaded Files</h3>
{% if user_files %}
    <ul>
    {% for f in user_files %}
        <li>
            {{ f.file.name|cut:"uploads/" }}
            (uploaded {{ f.uploaded_at|date:"Y-m-d H:i" }})
            <strong>expires {{ f.expires_at|date:"Y-m-d H:i" }}</strong>
            [<a href="{% url 'secure_download' f.id %}">Download</a>]
            [<a href="{% url 'delete_file' f.id %}">Delete</a>]
            [<a href="{% url 'share_file' f.id %}">Share</a>]
        </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No files uploaded yet.</p>
{% endif %}

<a href="{% url 'upload' %}">Upload More Files</a>
<a href="{% url 'logout' %}">Logout</a>

<h3>Files Shared With You</h3>
{% if shared_files %}
    <ul>
    {% for f in shared_files %}
        <li>
            {{ f.file.name|cut:"uploads/" }}
            (from {{ f.uploaded_by.username }})
            [<a href="{% url 'secure_download' f.id %}">Download</a>]
        </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No files have been shared with you yet.</p>
{% endif %}

{% endblock %}
